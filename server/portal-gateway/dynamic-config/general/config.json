{
  "http": {
    "routers": [
      {
        "name": "root",
        "middlewares": ["rootRedirectregex"],
        "rule": "Path('/')",
        "service": "dashboard-frontend"
      },
      {
        "name": "auth",
        "rule": "PathPrefix('/auth')",
        "service": "portal-iam"
      },

      {
        "name": "dashboard-frontend",
        "middlewares": [
          "dashboardRedirectRegex",
          "dashboardAuthBearer",
          "dashboardReplacePath"
        ],
        "rule": "PathPrefix('/dashboard')",
        "service": "dashboard-frontend"
      },
      {
        "name": "dashboard-service",
        "middlewares": ["dashboardAuthBearer"],
        "rule": "PathPrefix('/dashboard/service')",
        "service": "dashboard-service"
      },
      {
        "name": "dashboard-login",
        "middlewares": ["dashboardOauth2", "dashboardLoginRedirectRegex"],
        "rule": "Path('/dashboard/login')",
        "priority": 100,
        "service": "dashboard-frontend"
      },

      {
        "name": "navigation-frontend",
        "middlewares": [
          "navigationRedirectRegex",
          "navigationAuthBearer",
          "navigationReplacePath"
        ],
        "rule": "PathPrefix('/navigation')",
        "service": "navigation-frontend"
      },
      {
        "name": "navigation-service",
        "middlewares": ["navigationAuthBearer"],
        "rule": "PathPrefix('/navigation/service')",
        "service": "navigation-service"
      },

      {
        "name": "organisation-service",
        "middlewares": [
          "organisationRedirectRegex",
          "ShowSessionContentMiddleware",
          "organisationOauth2",
          "organisationAuthBearer",
          "organisationReplacePath"
        ],
        "rule": "PathPrefix('/organisation')",
        "service": "organisation-proxy-public"
      },

      {
        "name": "document-service",
        "middlewares": [
          "documentRedirectRegex",
          "documentOauth2",
          "documentAuthBearer",
          "documentReplacePath"
        ],
        "rule": "PathPrefix('/document')",
        "service": "document-proxy-public"
      }
    ],

    "middlewares": [
      {
        "name": "rootRedirectregex",
        "type": "redirectRegex",
        "options": { "regex": "^/$", "replacement": "/dashboard/" }
      },

      {
        "name": "dashboardLoginRedirectRegex",
        "type": "redirectRegex",
        "options": {
          "regex": "^(/dashboard/login)$",
          "replacement": "/dashboard/"
        }
      },
      {
        "name": "dashboardRedirectRegex",
        "type": "redirectRegex",
        "options": { "regex": "^(/dashboard)$", "replacement": "$1/" }
      },
      {
        "name": "dashboardReplacePath",
        "type": "replacePathRegex",
        "options": { "regex": "/dashboard/(.*)", "replacement": "/$1" }
      },

      {
        "name": "navigationRedirectRegex",
        "type": "redirectRegex",
        "options": { "regex": "^(/navigation)$", "replacement": "$1/" }
      },
      {
        "name": "navigationReplacePath",
        "type": "replacePathRegex",
        "options": { "regex": "/navigation/(.*)", "replacement": "/$1" }
      },

      {
        "name": "organisationRedirectRegex",
        "type": "redirectRegex",
        "options": { "regex": "^(/organisation)$", "replacement": "$1/" }
      },
      {
        "name": "organisationReplacePath",
        "type": "replacePathRegex",
        "options": { "regex": "/organisation/(.*)", "replacement": "/$1" }
      },

      {
        "name": "documentRedirectRegex",
        "type": "redirectRegex",
        "options": { "regex": "^(/document)$", "replacement": "$1/" }
      },
      {
        "name": "documentReplacePath",
        "type": "replacePathRegex",
        "options": { "regex": "/document/(.*)", "replacement": "/$1" }
      }
    ],

    "services": [
      {
        "name": "portal-iam",
        "servers": [
          { "host": "${host-prefix}${portal-iam.host}", "port": 8080 }
        ]
      },

      {
        "name": "dashboard-frontend",
        "servers": [
          { "host": "${host-prefix}${dashboard-frontend.host}", "port": 20025 }
        ]
      },
      {
        "name": "dashboard-service",
        "servers": [
          { "host": "${host-prefix}${dashboard-service.host}", "port": 20022 }
        ]
      },

      {
        "name": "navigation-frontend",
        "servers": [
          { "host": "${host-prefix}${navigation-frontend.host}", "port": 20015 }
        ]
      },
      {
        "name": "navigation-service",
        "servers": [
          { "host": "${host-prefix}${navigation-service.host}", "port": 20012 }
        ]
      },

      {
        "name": "organisation-proxy-public",
        "servers": [
          { "host": "${host-prefix}${organisation-proxy.host}", "port": 20030 }
        ]
      },

      {
        "name": "document-proxy-public",
        "servers": [
          { "host": "${host-prefix}${document-proxy.host}", "port": 20050 }
        ]
      }
    ]
  }
}
