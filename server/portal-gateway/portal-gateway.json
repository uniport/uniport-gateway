{
  "entrypoints": [
    {
      "name": "http20001",
      "port": 20001
    }
  ],
  "applications": [
    {
      "name": "proxy",
      "entrypoint": "http20001",
      "requestSelector": {
        "urlPrefix": "/"
      },
      "provider": "ProxyApplication"
    }
  ],

  "proxies": [
    {
      "name": "auth",
      "pathPrefix": "/auth",
      "middleware": {
        "headers": [ { "provider": "ForwardedHostHeader" } ]
      },
      "service": "portal-iam"
    },
    {
      "name": "navigation-service",
      "pathPrefix": "/navigation/service",
      "middleware": {
        "headers": [ { "provider": "AuthorizationBearerHeader" }, { "provider": "ForwardedHostHeader" } ]
      },
      "service": "navigation-service"
    },
    {
      "name": "navigation-frontend",
      "pathPrefix": "/navigation",
      "middleware": {
        "headers": [ { "provider": "AuthorizationBearerHeader" }, { "provider": "ForwardedHostHeader" } ],
        "uris": [ { "provider":  "ReplacePathByRegex", "regex": "^/navigation/", "replacement": "/"} ]
      },
      "service": "navigation-frontend"
    },
    {
      "name": "dashboard-service",
      "pathPrefix": "/dashboard/service",
      "middleware": {
        "headers": [ { "provider": "AuthorizationBearerHeader" }, { "provider": "ForwardedHostHeader" } ]
      },
      "service": "dashboard-service"
    },
    {
      "name": "dashboard-frontend",
      "pathPrefix": "/dashboard",
      "middleware": {
        "headers": [ { "provider": "AuthorizationBearerHeader" }, { "provider": "ForwardedHostHeader" } ],
        "uris": [ { "provider":  "ReplacePathByRegex", "regex": "^/dashboard/", "replacement": "/"} ]
      },
      "service": "dashboard-frontend"
    },
    {
      "name": "organisation",
      "pathPrefix": "/organisation",
      "service": "organisation-service",
      "oauth2": {
        "clientId": "Organisation",
        "clientSecret": "Organisation!",
        "discoveryUrl": "http://${portal-iam.host}:8080/auth/realms/portal"
      },
      "middleware": {
        "headers": [ { "provider": "AuthorizationBearerHeader" }, { "provider": "ForwardedHostHeader" } ],
        "uris": [ { "provider":  "ReplacePathByRegex", "regex": "^/organisation/", "replacement": "/" } ]
      }
    }
  ],
  "services": [
    {
      "name": "portal-iam",
      "provider": "com.inventage.portal.gateway.proxy.service.ServiceJsonFileProvider",
      "serverHost": "${portal-iam.host}",
      "serverPort": 8080
    },
    {
      "name": "navigation-frontend",
      "provider": "com.inventage.portal.gateway.proxy.service.ServiceJsonFileProvider",
      "serverHost": "${navigation-frontend.host}",
      "serverPort": 20015
    },
    {
      "name": "navigation-service",
      "provider": "com.inventage.portal.gateway.proxy.service.ServiceJsonFileProvider",
      "serverHost": "${navigation-service.host}",
      "serverPort": 20012
    },
    {
      "name": "dashboard-frontend",
      "provider": "com.inventage.portal.gateway.proxy.service.ServiceJsonFileProvider",
      "serverHost": "${dashboard-frontend.host}",
      "serverPort": 20025
    },
    {
      "name": "dashboard-service",
      "provider": "com.inventage.portal.gateway.proxy.service.ServiceJsonFileProvider",
      "serverHost": "${dashboard-service.host}",
      "serverPort": 20022
    },
    {
      "name": "organisation-service",
      "provider": "com.inventage.portal.gateway.proxy.service.ServiceJsonFileProvider",
      "serverHost": "${organisation-service.host}",
      "serverPort": 20030
    }
  ]
}