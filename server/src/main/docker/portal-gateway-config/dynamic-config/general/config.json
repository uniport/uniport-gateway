{
    "http": {
        "routers": [
            {
                "name": "root",
                "middlewares": ["rootRedirectregex"],
                "rule": "Path('/')",
                "service": "dashboard-proxy"
            },

            {
                "name": "login",
                "middlewares": ["dashboardOauth2", "loginRedirectRegex"],
                "rule": "PathPrefix('/login')",
                "service": "dashboard-proxy"
            },

            {
                "name": "logout",
                "middlewares": ["logoutRedirectRegex"],
                "rule": "PathPrefix('/logout')",
                "service": "navigation-proxy"
            },

            {
                "name": "dashboard-proxy",
                "middlewares": [
                    "dashboardRedirectRegex",
                    "dashboardAuthBearer",
                    "dashboardReplacePath"
                ],
                "rule": "PathPrefix('/dashboard')",
                "service": "dashboard-proxy"
            },

            {
                "name": "navigation-proxy",
                "middlewares": [
                    "navigationRedirectRegex",
                    "navigationAuthBearer",
                    "navigationReplacePath",
                    "sessionTerminate"
                ],
                "rule": "PathPrefix('/navigation')",
                "service": "navigation-proxy"
            },

            {
                "name": "organisation-proxy",
                "middlewares": [
                    "organisationRedirectRegex",
                    "ShowSessionContentMiddleware",
                    "organisationOauth2",
                    "organisationAuthBearer",
                    "organisationReplacePath"
                ],
                "rule": "PathPrefix('/organisation')",
                "service": "organisation-proxy"
            },

            {
                "name": "document-proxy",
                "middlewares": [
                    "documentRedirectRegex",
                    "documentOauth2",
                    "documentAuthBearer",
                    "documentReplacePath"
                ],
                "rule": "PathPrefix('/document')",
                "service": "document-proxy"
            },

            {
                "name": "filestorage-proxy",
                "middlewares": [
                    "filestorageRedirectRegex",
                    "filestorageAuthBearer",
                    "filestorageReplacePath"
                ],
                "rule": "PathPrefix('/filestorage')",
                "service": "filestorage-proxy"
            }
        ],

        "middlewares": [
            {
                "name": "rootRedirectregex",
                "type": "redirectRegex",
                "options": { "regex": "^/$", "replacement": "/dashboard/" }
            },

            {
                "name": "loginRedirectRegex",
                "type": "redirectRegex",
                "options": {
                    "regex": "^(/login)$",
                    "replacement": "/dashboard/"
                }
            },

            {
                "name": "logoutRedirectRegex",
                "type": "redirectRegex",
                "options": {
                    "regex": "^(/logout)$", "replacement": "/navigation/service/logout"
                }
            },

            {
                "name": "navigationRedirectRegex",
                "type": "redirectRegex",
                "options": { "regex": "^(/navigation)$", "replacement": "$1/" }
            },
            {
                "name": "navigationReplacePath",
                "type": "replacePathRegex",
                "options": { "regex": "/navigation/(.*)", "replacement": "/$1" }
            },

            {
                "name": "dashboardRedirectRegex",
                "type": "redirectRegex",
                "options": { "regex": "^(/dashboard)$", "replacement": "$1/" }
            },
            {
                "name": "dashboardReplacePath",
                "type": "replacePathRegex",
                "options": { "regex": "/dashboard/(.*)", "replacement": "/$1" }
            },

            {
                "name": "organisationRedirectRegex",
                "type": "redirectRegex",
                "options": {
                    "regex": "^(/organisation)$",
                    "replacement": "$1/"
                }
            },
            {
                "name": "organisationReplacePath",
                "type": "replacePathRegex",
                "options": {
                    "regex": "/organisation/(.*)",
                    "replacement": "/$1"
                }
            },

            {
                "name": "documentRedirectRegex",
                "type": "redirectRegex",
                "options": { "regex": "^(/document)$", "replacement": "$1/" }
            },
            {
                "name": "documentReplacePath",
                "type": "replacePathRegex",
                "options": { "regex": "/document/(.*)", "replacement": "/$1" }
            },

            {
                "name": "filestorageRedirectRegex",
                "type": "redirectRegex",
                "options": { "regex": "^(/filestorage)$", "replacement": "$1/" }
            },
            {
                "name": "filestorageReplacePath",
                "type": "replacePathRegex",
                "options": { "regex": "/filestorage/(.*)", "replacement": "/$1" }
            },
            {
                "name": "sessionTerminate",
                "type": "controlApi",
                "options": {
                    "action": "SESSION_TERMINATE"
                }
            }
        ],

        "services": [
            {
                "name": "dashboard-proxy",
                "servers": [
                    { "host": "${dashboard-proxy.host}", "port": "${dashboard-proxy.port}" }
                ]
            },

            {
                "name": "navigation-proxy",
                "servers": [
                    { "host": "${navigation-proxy.host}", "port": "${navigation-proxy.port}" }
                ]
            },

            {
                "name": "organisation-proxy",
                "servers": [
                    { "host": "${organisation-proxy.host}", "port": "${organisation-proxy.port}" }
                ]
            },

            {
                "name": "document-proxy",
                "servers": [{ "host": "${document-proxy.host}", "port": "${document-proxy.port}" }]
            },

            {
                "name": "filestorage-proxy",
                "servers": [{ "host": "${filestorage-proxy.host}", "port": "${filestorage-proxy.port}" }]
            }
        ]
    }
}
