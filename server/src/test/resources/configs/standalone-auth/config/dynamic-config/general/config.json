{
    "http": {
        "routers": [
            {
                "name": "auth",
                "rule": "PathPrefix('/auth')",
                "service": "iam"
            },
            {
                "name": "root",
                "rule": "Path('/')",
                "middlewares": [
                    "rootRedirectregex"
                ],
                "service": "whoami1"
            },
            {
                "name": "whoami1",
                "rule": "Path('/whoami1')",
                "middlewares": [
                    "whoami1AuthBearer"
                ],
                "service": "whoami1"
            },
            {
                "name": "whoami2",
                "rule": "Path('/whoami2')",
                "middlewares": [
                    "whoami2Oauth",
                    "whoami2AuthBearer"
                ],
                "service": "whoami2"
            },
            {
                "name": "whoami3",
                "rule": "Host('whoami3')",
                "middlewares": [
                    "whoami3Oauth",
                    "whoami3AuthBearer"
                ],
                "service": "whoami3"
            }
        ],
        "middlewares": [
            {
                "name": "rootRedirectregex",
                "type": "redirectRegex",
                "options": {
                    "regex": "^/$",
                    "replacement": "/whoami1"
                }
            },
            {
                "name": "whoami2Oauth",
                "type": "oauth2",
                "options": {
                    "clientId": "testclient",
                    "clientSecret": "**********",
                    "discoveryUrl": "http://localhost:8080/auth/realms/testrealm",
                    "sessionScope": "whoami2"
                }
            },
            {
                "name": "whoami3Oauth",
                "type": "oauth2",
                "options": {
                    "clientId": "testclient",
                    "clientSecret": "**********",
                    "discoveryUrl": "http://localhost:8080/auth/realms/testrealm",
                    "sessionScope": "whoami3"
                }
            },
            {
                "name": "whoami1AuthBearer",
                "type": "authorizationBearer",
                "options": {
                    "sessionScope": "whoami2"
                }
            },
            {
                "name": "whoami2AuthBearer",
                "type": "authorizationBearer",
                "options": {
                    "sessionScope": "whoami2"
                }
            },
            {
                "name": "whoami3AuthBearer",
                "type": "authorizationBearer",
                "options": {
                    "sessionScope": "whoami3"
                }
            }
        ],
        "services": [
            {
                "name": "whoami1",
                "servers": [
                    {
                        "host": "localhost",
                        "port": "8081"
                    }
                ]
            },
            {
                "name": "whoami2",
                "servers": [
                    {
                        "host": "localhost",
                        "port": "8082"
                    }
                ]
            },
            {
                "name": "whoami3",
                "servers": [
                    {
                        "host": "localhost",
                        "port": "8083"
                    }
                ]
            },
            {
                "name": "iam",
                "servers": [
                    {
                        "host": "localhost",
                        "port": "8080"
                    }
                ]
            }
        ]
    }
}
