{
    "entrypoints": [
        {
            "name": "http20000",
            "port": 20000,
            "middlewares": [
                {
                    "name": "openTelemetry",
                    "type": "openTelemetry"
                },
                {
                    "name": "responseSessionCookieRemoval",
                    "type": "responseSessionCookieRemoval"
                },
                {
                    "name": "sessionTerminate",
                    "type": "controlApi",
                    "options": {
                        "action": "SESSION_TERMINATE"
                    }
                },
                {
                    "name": "sessionReset",
                    "type": "controlApi",
                    "options": {
                        "action": "SESSION_RESET",
                        "iamSessionResetUrl": "http://${PORTAL_GATEWAY_PORTAL_IAM_HOST}:${PORTAL_GATEWAY_PORTAL_IAM_PORT}/auth/realms/portal/session_reset"
                    }
                },
                {
                    "name": "session",
                    "type": "session",
                    "options": {
                        "lifetimeCookie": true,
                        "idleTimeoutInMinute": 30,
                        "uriWithoutSessionTimeoutReset": "^/analytics/pmt.pmt\\?ping.*|.*_uniport-polling_.*|.*conversation/polling/v1/.*"
                    }
                },
                {
                    "name": "requestResponseLogger",
                    "type": "requestResponseLogger",
                    "options": {
                        "uriWithoutLoggingRegex": "/health.*|/ready.*",
                        "contentTypes": [
                            "text/plain",
                            "application/json"
                        ]
                    }
                },
                {
                    "name": "replacedSessionCookieDetection",
                    "type": "replacedSessionCookieDetection"
                },
                {
                    "name": "whitelistedCookiesInSessionBag",
                    "type": "sessionBag",
                    "options": {
                        "whitelistedCookies": [
                            {
                                "name": "KEYCLOAK_SESSION",
                                "path": "/auth/realms/master/"
                            },
                            {
                                "name": "KEYCLOAK_SESSION_LEGACY",
                                "path": "/auth/realms/master/"
                            },
                            {
                                "name": "KEYCLOAK_SESSION",
                                "path": "/auth/realms/portal/"
                            },
                            {
                                "name": "KEYCLOAK_SESSION_LEGACY",
                                "path": "/auth/realms/portal/"
                            },
                            {
                                "name": "uniport.language",
                                "path": "/"
                            },
                            {
                                "name": "ips.language",
                                "path": "/"
                            }
                        ]
                    }
                },
                {
                    "name": "csp",
                    "type": "csp",
                    "options": {
                        "policyDirectives": [
                            {
                                "directive": "report-to",
                                "values": [
                                    "/csp-reports"
                                ]
                            },
                            {
                                "directive": "report-uri",
                                "values": [
                                    "/csp-reports"
                                ]
                            },
                            {
                                "directive": "default-src",
                                "values": [
                                    "self"
                                ]
                            },
                            {
                                "directive": "style-src",
                                "values": [
                                    "https://fonts.googleapis.com",
                                    "https://fonts.gstatic.com",
                                    "https://cdn.jsdelivr.net",
                                    "self",
                                    "unsafe-inline"
                                ]
                            },
                            {
                                "directive": "font-src",
                                "values": [
                                    "https://fonts.googleapis.com",
                                    "https://fonts.gstatic.com",
                                    "https://cdn.jsdelivr.net",
                                    "self",
                                    "data:"
                                ]
                            },
                            {
                                "directive": "script-src",
                                "values": [
                                    "self",
                                    "blob:",
                                    "unsafe-inline",
                                    "unsafe-eval",
                                    "https://cdn.jsdelivr.net"
                                ]
                            },
                            {
                                "directive": "img-src",
                                "values": [
                                    "self",
                                    "data: https:"
                                ]
                            },
                            {
                                "directive": "connect-src",
                                "values": [
                                    "self",
                                    "https://fonts.googleapis.com"
                                ]
                            }
                        ]
                    }
                }
            ]
        }
    ],
    "applications": [
        {
            "name": "proxy",
            "entrypoint": "http20000",
            "requestSelector": {
                "urlPrefix": "/"
            },
            "provider": "ProxyApplication"
        }
    ],
    "providers": [
        {
            "name": "file",
            "directory": "./dynamic-config",
            "watch": false
        }
    ]
}
